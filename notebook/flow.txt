START
  â”‚
  â–¼
[Raw Data]
  - Anime dataset (df)
    - Columns: anime_id, name, genre, eng_version, etc.
  - User ratings dataset (rating_df)
    - Columns: user_id, anime_id, rating
  â”‚
  â–¼
[Preprocessing / Encoding]
  - Map users and anime to continuous indexes:
      user2user_encoded, user2user_decoded
      anime2anime_encoded, anime2anime_decoded
  - Prepare train/test arrays:
      X_train_array, X_test_array
      y_train, y_test
  â”‚
  â–¼
[Model: RecommenderNet()]
  Inputs:
    - user_id
    - anime_id
  Embeddings:
    - user_embedding (size 128)
    - anime_embedding (size 128)
  Interaction:
    - Dot product of embeddings (cosine similarity)
  Dense + Activation:
    - Dense(1) â†’ Sigmoid â†’ probability of liking
  Compile:
    - Loss: binary_crossentropy
    - Optimizer: Adam
  â”‚
  â–¼
[Training the Model]
  - Learning Rate Scheduler (lrfn)
  - ModelCheckpoint â†’ save best weights
  - EarlyStopping â†’ stop if val_loss stops improving
  - Batch training (X_train_array, y_train)
  - Output: Trained model with learned embeddings
  â”‚
  â–¼
[Extract Embeddings]
  - user_weights = extract_weights("user_embedding", model)
  - anime_weights = extract_weights("anime_embedding", model)
  - Each user/anime now has a vector representation
  â”‚
  â–¼
[Similarity Computations]
  â”œâ”€ find_similar_users(user_id, ...) â†’ similar users
  â””â”€ find_similar_animes(anime_name, ...) â†’ similar anime
  â”‚
  â–¼
[Hybrid Recommendation Function]
  Input: user_id, user_weight, content_weight
  Steps:
    1. User-Based Recommendation:
        - Find similar users
        - Get what they liked (user_recommended_anime_list)
    2. Content-Based Recommendation:
        - For each anime in user list â†’ find similar animes
        - Merge into content_recommended_animes
    3. Combine Scores:
        - Score = user_weight for user-based
        - Score = content_weight for content-based
        - If anime appears in both â†’ sum weights
    4. Sort Scores:
        - Descending â†’ top recommendations
  Output: top 10 anime names for user
  â”‚
  â–¼
[Optional: Additional Features]
  - Can return similarity scores
  - Can exclude already watched anime
  - Can adjust weights for hybrid recommendation
  â”‚
  â–¼
[Output]
  - Recommended anime list
  - Example: ['Naruto', 'Bleach', 'One Piece', 'Naruto Shippuden', 'Boruto']
  â”‚
  â–¼
END



ğŸŸ¢ Anime Recommender â€“ One-Line Flow

Raw Data: Collect anime info (df) and user ratings (rating_df).

Preprocessing: Encode user IDs and anime IDs into continuous indexes for training.

Model (RecommenderNet): Input user & anime â†’ embeddings â†’ dot product â†’ sigmoid â†’ predicted probability of liking.

Training: Use binary cross-entropy loss, Adam optimizer, learning rate schedule, early stopping, and checkpointing.

Extract Embeddings: Pull user_embedding and anime_embedding vectors from the trained model.

User Similarity: Use user embeddings to find similar users.

Content Similarity: Use anime embeddings to find similar animes for each user-preferred anime.

Hybrid Recommendation: Combine user-based and content-based scores using weights â†’ sum if overlap â†’ rank by total score.

Output Recommendations: Return top N anime names for the user.

ğŸ’¡ Memory Tip:

Data â†’ Train â†’ Embeddings â†’ Similarity â†’ Hybrid â†’ Output

Think of embeddings as â€œhidden taste profilesâ€ and dot product as compatibility.